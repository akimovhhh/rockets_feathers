# Rockets & Feathers: U.S. Egg Market Pass-Through Analysis

This repository analyzes price pass-through dynamics and asymmetries in the U.S. egg market using reduced-form econometric methods and instrumental variables. The project investigates how wholesale and retail egg prices respond to supply shocks (layer mortality) and input cost changes (feed prices).

## What's Inside

```
eggs/
├── code/
│   ├── data_extraction/
│   │   └── usda_data_extraction.ipynb    # USDA NASS API & AMS data collection
│   └── data_analysis/
│       ├── egg_pass_through_usda.ipynb   # Main reduced-form & IV analysis
│       └── egg_pass_through_ppi_cpi.ipynb # PPI/CPI pass-through analysis
├── data/
│   ├── usda/                            # Processed monthly USDA/NASS data
│   ├── cpi_ppi/                         # CPI/PPI indices for eggs
│   └── 2848_txt/                        # USDA AMS historical egg price reports (txt)
└── plots/
    ├── usda/                            # Output plots from USDA analysis
    └── cpi_ppi/                         # Output plots from PPI/CPI analysis
```

## How to Run

### Prerequisites
- Jupyter Notebook

### Step 1: Data Extraction
Open and run eggs/code/data_extraction/usda_data_extraction.ipynb
- Fetches corn/soy prices from USDA NASS API (API KEY needed)
- Fetches poultry data (layer inventory, mortality, egg production)
- Parses historical egg prices from AMS txt files
- Aggregates to monthly data
- Outputs CSVs to usda

### Step 2: Analysis
Run either or both analysis notebooks:

**For cost pass-through analysis with USDA data:**
```bash
jupyter notebook eggs/code/data_analysis/egg_pass_through_usda.ipynb
```
- Reduced-form OLS: price changes on mortality windows (lags 0–2, 3–6, 7–12 months)
- IV/2SLS with mortality as instrument
- Asymmetry tests (positive vs. negative shocks)
- Month fixed effects

**For cost pass-through analysis with PPI/CPI:**
```bash
jupyter notebook eggs/code/data_analysis/egg_pass_through_ppi_cpi.ipynb
```
- Analyzes PPI/CPI pass-through dynamics
- Time-series analysis and cointegration checks

## Data Requirements

### Input Data Location
All data should be placed in data:

- **USDA NASS data** (generated by extraction notebook):
  - `usda/cost_corn_us.csv`
  - `usda/cost_sb_us.csv`
  - `usda/egg_prod_doz.csv`
  - `usda/layer_inv.csv`
  - `usda/loss_dth_render.csv`
  - `usda/warehouse_price_monthly.csv`
  - `usda/reduced_form.csv` (merged dataset, FRED)
  - `usda/retail_price.csv`

- **AMS Historical Data**:
  - `2848_txt/` folder with `.txt` files (manually downloaded from MMN, report 2848)

- **CPI/PPI Data**:
  - Manualy downloaded

### External APIs
- **USDA NASS API**: Requires `NASS_KEY` environment variable
- **USDA AMS API**: Requires `AMS_KEY` environment variable

Store these in `~/.config/mysecrets/env` and load via `python-dotenv`.

## Reproducibility Notes

### Environment
- Python 3.10.8
- Key packages: `pandas`, `statsmodels`, `numpy`, `plotly`, `scipy`, `linearmodels`

### Expected Outputs

**From egg_pass_through_usda.ipynb:**
- Regression tables with HAC-robust standard errors (3–12 lags)
- Joint F-tests for mortality window blocks
- IV/2SLS specification diagnostics (Wu–Hausman, Sargan tests)
- Plots: time-series of prices/mortality, pass-through dynamics
- Saved to usda

**From egg_pass_through_ppi_cpi.ipynb:**
- Cointegration tests, autocorrelation diagnostics
- Pass-through elasticity estimates
- Time-series plots and comparative analysis
- Saved to cpi_ppi

### Data Coverage
- **Main analysis period**: 2018-01-01 to 2025-10-01 (monthly)
- **Historical prices**: 2017-11-03 onwards (weekly, aggregated to monthly)

### Notes
- Mortality is aggregated into three time windows to capture supply-chain adjustment delays
- Feed costs have weak predictive power in this sample; included as robustness
- All regressions use HAC covariance with data-dependent lag selection
- Plots use UC Berkeley colors (blue #002676, gold #FDB515)
